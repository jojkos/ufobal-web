<div st-table="rows" st-safe-src="players" ng-hide="player">
    <input st-search="nickname" placeholder="hledat..." class="input-sm form-control" type="search"/>
    <table class="smart-table">
        <thead>
        <tr>
            <th width="30%" st-sort="nickname" st-sort-default="true">Jméno</th>
            <th width="40%">týmy</th>
            <th class="text-right" st-sort="goalsSum">góly</th>
            <th class="text-right" st-sort="assistsSum">asistence</th>
            <th class="text-right" st-sort="canada">kanada</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="player in rows">
            <td><a ng-class="player.gender" href="" ng-click="selectPlayer(player)">{{player.nickname}}</a></td>
            <td>
                <span ng-repeat="(pk, t) in player.teams">{{ t.team.name }} ({{ t.count }}x)<span ng-hide="$last">, </span></span>
            </td>
            <td class="text-right">{{ player.goalsSum }}</td>
            <td class="text-right">{{ player.assistsSum }}</td>
            <td class="text-right">{{ player.canada }}</td>
        </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="15" class="text-center">
                    <div st-pagination="" st-items-by-page="20" st-displayed-pages="10" st-template="utils/st-pagination.html"></div>
                </td>
            </tr>
        </tfoot>
    </table>
</div>


<div ng-cloak ng-show="player">
    <div>
        <a ng-click="closePlayer()" class="left">&lsaquo; zpět</a>
        <hr>
        <a ng-hide="edit" ng-click="edit=true" class="right"><i class="fi-pencil"></i> upravit profil</a>

        <h1> &nbsp; {{ player.nickname }} </h1>
        <h2 ng-class="{man: player.gender=='man', woman: player.gender=='woman'}">
            {{ player.name }} {{ player.lastname }} ({{ player.age }})
        </h2>

    </div>

    <div ng-cloak ng-show="edit">
        <hr>
        <a ng-click="edit=false" class="right"><i class="fi-x"></i> zrušit změny</a>


        <div class="row">
            <div class="columns medium-3">
                <label>Přezdívka
                    <input type="text" ng-model="player.nickname" />
                </label>
            </div>
        </div>
        <div class="row">
            <div class="columns medium-3">
                <label>Jméno
                    <input type="text" ng-model="player.name" />
                </label>
            </div>
            <div class="columns medium-3">
                <label>Příjmení
                    <input type="text" ng-model="player.lastname" />
                </label>
            </div>
            <div class="columns medium-6"></div>
        </div>
        <div class="row">
            <div class="columns medium-3">
                <label>Pohlaví
                    <select
                        ng-model="player.gender"
                        ng-options="gender.id as gender.text for gender in genders">
                        <option value="">----</option>
                    </select>
                </label>
            </div>
        </div>
        <div class="row">
            <div class="columns medium-3">
                <label>Datum narození
                    <input type="date" ng-change="computeAge()" ng-model="player.birthdate">
                </label>
            </div>
             <div class="columns medium-3">
                <label>Věk
                    <input disabled type="text" ng-model="player.age" />
                </label>
            </div>
            <div class="columns medium-6"></div>
        </div>
        <i>Datum narození nebude nikde zveřejňováno (pouze jako věk).</i>
        <br>

        <button ng-hide="player.saving" ng-click="save()">Uložit</button>
        <div ng-show="player.saving" class="loader small"></div>
    </div>

    <hr>

    <h3>Turnaje</h3>

    <table>
        <thead>
            <tr>
                <th>Turnaj</th>
                <th>Tým</th>
                <th class="text-right">Góly</th>
                <th class="text-right">Asistence</th>
                <th class="text-right">Kanada</th>
                <th>smazat</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="t in player.tournaments">
                <td>{{ t.tournament.name }}  {{ t.tournament.year }}</td>
                <td>{{ t.name }}</td>
                <td class="text-right">{{ player.goals[t.tournament.pk] }}</td>
                <td class="text-right">{{ player.assists[t.tournament.pk] }}</td>
                <td class="text-right">{{ player.goals[t.tournament.pk] + player.assists[t.tournament.pk] }}</td>
                <td class="text-right"><a class="fi-x" ng-click="removeAttendance(t)"></a></td>
            </tr>
        </tbody>
    </table>
    <hr>
    <div class="row">
        <div class="text-right columns small-2">
            <select
                ng-model="selectedTournament"
                ng-options="tournament as tournament.name + ' ' + tournament.year for tournament in tournaments | orderBy:'-date'">
                <option value="">----</option>
            </select>
        </div>
        <div class="columns small-2">
            <select
                ng-model="selectedTeam"
                ng-options="team as team.name for team in selectedTournament.teamOnTournaments | orderBy:'name'">
                <option value="">----</option>
            </select>
        </div>
        <div class="columns small-2"><a class="fi-plus" ng-click="addAttendance()"> přidat</a></div>
        <div class="columns small-6"><div ng-show="player.saving" class="loader small"></div></div>
    </div>
</div>